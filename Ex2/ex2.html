<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>EXERCICI 1</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="ex2.css">
</head>

<body>
    <div id="buscador">
        <div class="input_area">
            <label for="genero">Genre: </label>
            <input type="text" id="genre" name="genre">
        </div>
        <div class="input_area">
            <label for="genero">Year: </label>
            <input type="text" id="year" name="year">
        </div>
        <button id="buscar">Search</button>
    </div>
    <div id="movies">
    </div>

    <script>
        $(document).ready(function () {
            $.ajax({
                url: "https://api.themoviedb.org/3/movie/popular",
                data: {
                    api_key: "70e3f40893b2eca95529f5c72c1a3f1c"
                },
                success: function (data) {
                    console.log(data);
                    var peliculas = data.results;
                    var info = "<table><tr><th></th><th>Titulo</th><th>Genero</th><th>Director</th>";
                    info += "<th>Lanzamiento</th><th>Duracion</th><th>Sinopsis</th></tr>";
                    for (var i = 0; i <peliculas.length; i++) {
                        // if ((genre == peliculas[i].Genero && year == peliculas[i].Year) || (year=="All" && genre == peliculas[i].Genero) 
                        // || (genre=="All" && year == peliculas[i].Year) || (genre == "All" && year == "All")) {
                        $.ajax({
                            url: "https://api.themoviedb.org/3/movie/" + peliculas[i].id,
                            data: {
                                api_key: "70e3f40893b2eca95529f5c72c1a3f1c"
                            },
                            success: function (filmdetails) {
                                console.log("eee" + filmdetails);
                                let compania = filmdetails.production_companies.length == 0 ? "No hay" : filmdetails.production_companies[0].name;
                                info += "<tr><td><img class='poster' src='https://image.tmdb.org/t/p/w500" + filmdetails.poster_path + "'></td>";
                                info += "<td>" + filmdetails.original_title + "</td>";
                                info += "<td>" + filmdetails.genres[0].name + "</td>";
                                 info += "<td>" + compania + "</td>";
                                info += "<td>" + filmdetails.release_date + "</td>";
                                info += "<td>" + filmdetails.Duracion + "</td>";
                                info += "<td id='sinopsis'>" + filmdetails.overview + "</td>";
                                info += "</tr>";
                                
                                 $("#movies").html(info);
                            }
                        });
                        // }
                        // info += 
                    };
                   $("#movies").append("</table>");
                }
            });
        });
    </script>
</body>

</html>